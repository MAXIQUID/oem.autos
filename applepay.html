<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Apple Pay Meme</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background: #000;
      color: #0f0;
      font-family: Arial, sans-serif;
      overflow: hidden;
      cursor: pointer;
    }
    #card {
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 0.3s, transform 0.3s;
    }
    #card.show {
      opacity: 1;
      transform: scale(1);
    }
    #amount {
      font-size: 3em;
      margin-top: 20px;
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.4s, transform 0.4s;
    }
    #amount.show {
      opacity: 1;
      transform: translateY(0);
    }
    #faceid {
      position: absolute;
      top: 20px;
      font-size: 2em;
      opacity: 0;
      transition: opacity 0.5s;
    }
    #faceid.show {
      opacity: 1;
    }
    #finessed {
      position: absolute;
      bottom: 20px;
      font-size: 2em;
      color: red;
      opacity: 0;
      transition: opacity 1s;
    }
    #finessed.show {
      opacity: 1;
    }
  </style>
</head>
<body>
  <div id="card">ðŸ’³</div>
  <div id="amount">+$0.00</div>
  <div id="faceid">ðŸ”’ Face ID</div>
  <div id="finessed">You got finessed ðŸ’¸</div>

  <script>
    let tapCount = 0;
    const display = document.getElementById("amount");
    const card = document.getElementById("card");
    const finessed = document.getElementById("finessed");
    const faceid = document.getElementById("faceid");

    // Base URL for sounds
    const baseUrl = "https://www.myinstants.com";

    // Cash ding sound (clone for stacking)
    const cashSrc = baseUrl + "/media/sounds/applepay.mp3";

    // Meme sounds for ad-libs
    const memeSounds = [
      "/media/sounds/among-us-role-reveal-sound.mp3",
      "/media/sounds/vine-boom-sound-effect_KT89XIq.mp3",
      "/media/sounds/emotional-damage-meme.mp3",
      "/media/sounds/fart-meme-sound.mp3"
    ].map(src => baseUrl + src);

    // Cancelable animation state
    let amountAnimationId = null;
    let faceidTimeoutId = null;

    function playCashSound() {
      const audio = new Audio(cashSrc);
      audio.volume = 1.0;
      audio.play().catch(()=>{});
    }

    function playRandomMemeSound() {
      const src = memeSounds[Math.floor(Math.random() * memeSounds.length)];
      const audio = new Audio(src);
      audio.volume = 1.0;
      audio.play().catch(()=>{});
    }

    function animateAmount(finalValue) {
      if (amountAnimationId) cancelAnimationFrame(amountAnimationId);
      let current = 0;
      const step = Math.max(0.5, finalValue / 40);

      function tick() {
        current += step;
        if (current >= finalValue) {
          display.textContent = `+$${finalValue.toFixed(2)}`;
          amountAnimationId = null;
          return;
        }
        display.textContent = `+$${current.toFixed(2)}`;
        amountAnimationId = requestAnimationFrame(tick);
      }
      tick();
    }

    document.body.addEventListener("click", () => {
      tapCount++;

      // Always ding (stackable)
      playCashSound();

      // Meme ad-libs every 2nd tap
      if (tapCount % 2 === 0) {
        playRandomMemeSound();
      }

      if (navigator.vibrate) navigator.vibrate([50,30,80,30,50]);

      card.classList.add("show");

      // Reset Face ID
      if (faceidTimeoutId) clearTimeout(faceidTimeoutId);
      faceid.classList.remove("show");
      void faceid.offsetWidth;
      faceid.classList.add("show");

      faceidTimeoutId = setTimeout(() => {
        faceid.classList.remove("show");

        const amounts = [4.99, 9.99, 14.50, 19.99, 24.00, 49.99, 79.00, 129.99, 199.00];
        const randomAmount = amounts[Math.floor(Math.random() * amounts.length)];

        display.classList.remove("show");
        void display.offsetWidth;
        display.classList.add("show");
        animateAmount(randomAmount);

        if (tapCount === 5) {
          finessed.classList.add("show");
        }
      }, 1500);
    });
  </script>
</body>
</html>