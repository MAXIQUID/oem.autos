<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Apple Pay Prank</title>
  <style>
    body {
      background: #000;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
      user-select: none;
    }
    #card {
      width: 280px;
      height: 180px;
      background: linear-gradient(135deg, #333, #111);
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(0,0,0,0.8);
      opacity: 0;
      transform: translateY(60px) scale(0.9);
      transition: all 0.5s ease;
    }
    #card.show {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
    #faceid {
      position: absolute;
      top: 20%;
      font-size: 42px;
      color: #0f0;
      opacity: 0;
      transition: opacity 0.5s;
    }
    #faceid.show {
      opacity: 1;
    }
    #amount {
      position: absolute;
      bottom: 25%;
      font-size: 36px;
      color: #0f0;
      opacity: 0;
      transition: opacity 0.4s;
    }
    #amount.show {
      opacity: 1;
    }
    #finessed {
      position: absolute;
      bottom: 10%;
      font-size: 32px;
      font-weight: bold;
      color: red;
      opacity: 0;
      transition: opacity 0.6s ease-in-out;
    }
    #finessed.show {
      opacity: 1;
    }
  </style>
</head>
<body>
  <div id="card"></div>
  <div id="faceid">ðŸ”“ Face ID</div>
  <div id="amount"></div>
  <div id="finessed">YOU GOT FINESSED ðŸ’¸</div>

  <script>
    let tapCount = 0;
    const display = document.getElementById("amount");
    const card = document.getElementById("card");
    const finessed = document.getElementById("finessed");
    const faceid = document.getElementById("faceid");

    // Sounds
    const baseUrl = "https://www.myinstants.com";
    function loadSound(src) {
      const a = new Audio(baseUrl + src);
      a.preload = "auto";
      return a;
    }

    const cashSoundSrc = "/media/sounds/applepay.mp3";
    const memeSoundSrcs = [
      "/media/sounds/among-us-role-reveal-sound.mp3",
      "/media/sounds/vine-boom-sound-effect_KT89XIq.mp3",
      "/media/sounds/emotional-damage-meme.mp3",
      "/media/sounds/fart-meme-sound.mp3"
    ];

    const memeSounds = memeSoundSrcs.map(loadSound);

    // Cancelable animation state
    let amountAnimationId = null;
    let faceidTimeoutId = null;

    function playCashSound() {
      // Clone so multiple can overlap without cutting
      const cash = new Audio(baseUrl + cashSoundSrc);
      cash.play().catch(()=>{});
    }

    function playRandomMemeSound() {
      const audio = memeSounds[Math.floor(Math.random() * memeSounds.length)];
      audio.currentTime = 0;
      audio.play().catch(()=>{});
    }

    function animateAmount(finalValue) {
      if (amountAnimationId) cancelAnimationFrame(amountAnimationId);
      let current = 0;
      const step = Math.max(0.5, finalValue / 40);

      function tick() {
        current += step;
        if (current >= finalValue) {
          display.textContent = `+$${finalValue.toFixed(2)}`;
          amountAnimationId = null;
          return;
        }
        display.textContent = `+$${current.toFixed(2)}`;
        amountAnimationId = requestAnimationFrame(tick);
      }
      tick();
    }

    document.body.addEventListener("click", () => {
      tapCount++;

      // Always play cash
      playCashSound();

      // Meme sound every 2nd tap
      if (tapCount % 2 === 0) {
        playRandomMemeSound();
      }

      if (navigator.vibrate) navigator.vibrate([50,30,80,30,50]);

      card.classList.add("show");

      // Reset Face ID animation
      if (faceidTimeoutId) clearTimeout(faceidTimeoutId);
      faceid.classList.remove("show");
      void faceid.offsetWidth; // reflow
      faceid.classList.add("show");

      faceidTimeoutId = setTimeout(() => {
        faceid.classList.remove("show");

        const amounts = [4.99, 9.99, 14.50, 19.99, 24.00, 49.99, 79.00, 129.99, 199.00];
        const randomAmount = amounts[Math.floor(Math.random() * amounts.length)];

        display.classList.remove("show");
        void display.offsetWidth;
        display.classList.add("show");
        animateAmount(randomAmount);

        if (tapCount === 5) {
          finessed.classList.add("show");
        }
      }, 1500);
    });
  </script>
</body>
</html>